#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language american
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 3cm
\topmargin 2cm
\rightmargin 3cm
\bottommargin 2cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip smallskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Boltzmann Generators
\end_layout

\begin_layout Author
Frank No√© and Hao Wu
\end_layout

\begin_layout Abstract
Computing equilibrium structures and statistics of condensed-matter many-body
 systems such as spin systems or macromolecules in solution is a computationally
 intensive task that presently uses algorithms such as molecular dynamics
 (MD) simulation or Markov-chain Monte Carlo (MCMC) that need to take many
 small steps in configuration space until statistical estimates are converged.
 Here we develop Boltzmann Generators, a deep learning method that learns
 a variable transformation such that the equilibrium distribution of a given
 many-body system can be 
\begin_inset Quotes eld
\end_inset

one-shot
\begin_inset Quotes erd
\end_inset

 sampled, i.e.
 by sampling statistically independent random variables from a simple distributi
on in the transformed space.
 This is achieved by combining recent developments in directed generative
 neural networks with principles of equilibrium statistical mechanics.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Next TODOs
\series default
:
\end_layout

\begin_layout Itemize

\series bold
Clean up temperature prefactor mess
\series default
: analysis.free_energy_bootstrap(), EnergyInvNet.sample(), ...
 Where do we need to include the temperature factor, and where not? How
 should weights be interpreted?
\end_layout

\begin_layout Itemize

\series bold
Multi-temperature
\series default
: Training with more temperatures, train with gradual removing of ML part.
 Test if we can reach a situation where zero ML contribution is stable and
 doesn't lead to an exploding z space.
\end_layout

\begin_layout Itemize
Understand bimodality in J values for unsupervised training (Idea: the network
 takes most of the z-density and scales it to a small x region)
\end_layout

\begin_deeper
\begin_layout Itemize
Fix 1: Re-introduce J-restraint in last training stage
\end_layout

\begin_layout Itemize
Fix 2: Combine supervised + unsupervised
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section*
Done
\end_layout

\begin_layout Itemize

\series bold
(done) Multi-Temperature
\series default
:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
rc_entropy
\series default
 does currently not depend on temperature, therefore we try to make the
 sum distribution uniform, which is not correct.
\end_layout

\begin_layout Itemize

\series bold
W2-loss
\series default
 different temperatures may have different scaling factors.
 Therefore making the weights of all temperatures equal without considering
 the weighting factors probably does not have the correct effect.
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
(failure) Center distributions
\series default
: Each trajectory should be centered (mean 0) or subject to ML.
 How can we do that rather than splitting the space between trajectories?
 
\end_layout

\begin_layout Itemize

\series bold
(failed) Heavy tail distribution
\series default
: Seems to just reparametrize the same problem.
\end_layout

\begin_layout Itemize
Optimizing acceptance rate 
\series bold
supervised problem
\series default
: One of the two states dominates, even when we train with metric
\end_layout

\begin_deeper
\begin_layout Itemize
(
\series bold
failed
\series default
) Fix 1: symmetric: does not fix it.
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section*
Minimal Paper Checklist
\end_layout

\begin_layout Itemize

\series bold
Form
\series default
: 3-page style Science or Nat.
 Phys.
 + SI.
\end_layout

\begin_layout Itemize
(
\series bold
Done
\series default
) Latent sampling idea.
 Sell as 
\begin_inset Quotes eld
\end_inset

variable/coordinate transformation
\begin_inset Quotes erd
\end_inset

 to physicists.
\end_layout

\begin_layout Itemize
Demonstrate that realistic structures / low energies can be sampled directly
 for 3 systems: 
\end_layout

\begin_deeper
\begin_layout Itemize
(
\series bold
Done
\series default
) double well
\end_layout

\begin_layout Itemize
(
\series bold
Done
\series default
) particle system
\end_layout

\begin_layout Itemize
hydrocarbons.
\end_layout

\end_deeper
\begin_layout Itemize
Demonstrate that free energy differences can be computed efficiently for
 3 systems
\end_layout

\begin_deeper
\begin_layout Itemize
(
\series bold
Done
\series default
) double well
\end_layout

\begin_layout Itemize
(
\series bold
Done
\series default
) particle system
\end_layout

\begin_layout Itemize
protein.
\end_layout

\end_deeper
\begin_layout Itemize
Hydrocarbons:
\end_layout

\begin_deeper
\begin_layout Itemize
Generate Structures for cyclical (9-) hydrocarbon and polycyclical (?)
\end_layout

\end_deeper
\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="14">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n_{l}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w_{ML}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w_{KL}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $ex$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n_{l}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w_{ML}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w_{KL}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $ex$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
267
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
283
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
456
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
49
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
437
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
157
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
138
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
362
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
51
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
448
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
34
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
514
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
47
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
567
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
267
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
54
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
547
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Itemize
Outline ideas to extend this method to Latent MCMC, FEP, Adaptive sampling
 etc.
 (+demonstrate for double well? Danger: request to do this for the other
 systems as well, but it doesn't work well for those yet)
\end_layout

\begin_layout Itemize
Symbols: We have used 
\begin_inset Formula $S$
\end_inset

 and 
\begin_inset Formula $T$
\end_inset

 for the nonlinear transformations in the NN.
 Then it is confusing to also use 
\begin_inset Formula $T$
\end_inset

 (
\begin_inset Formula $T_{xy}/T_{yx}$
\end_inset

) for the whole network.
 Maybe 
\begin_inset Formula $F$
\end_inset

?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section*
Overview / TODOs
\end_layout

\begin_layout Enumerate

\series bold
Data
\series default
: Long Hungarian Trajectory is so far the best.
 Couldn't get similar performance with restrained trajectory.
\end_layout

\begin_layout Enumerate

\series bold
Training
\series default
: 
\end_layout

\begin_deeper
\begin_layout Enumerate
Implement training of Gaussian in 
\begin_inset Formula $z$
\end_inset

 and likelihood in 
\begin_inset Formula $x$
\end_inset

 simultaneously (I have started this, but there was a bug)
\end_layout

\begin_layout Enumerate
(
\series bold
done
\series default
) Hyperparameters for z training: now we mainly do KL training, so this
 is not so important.
 Just avoid overfitting at this stage by doing early stopping.
\end_layout

\begin_layout Enumerate
Hyperparameters for E training: The resulting network can perform quite
 efficiently with Prior MCMC when being sampled using the same 
\begin_inset Formula $\mathbf{z}$
\end_inset

 standard deviation used in training.
 Some sampling data for the particle dimer system with distance 
\begin_inset Formula $d$
\end_inset

, where training has been done with samples from 
\begin_inset Formula $\sigma_{\mathbf{z}}$
\end_inset

: 
\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma_{\mathbf{z}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{\mathrm{transition}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{acf}_{\tau=100}(d)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{acf}_{\tau=10,000}(d)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.89
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.02 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.89
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.05 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.74
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.98
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.40
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
38 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.98
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.68
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.68
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.21
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10159
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.65
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.09
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5945
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.69
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
516
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.92
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.36
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.78
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Hyperparameter search for E training
\series default
.
 
\end_layout

\begin_deeper
\begin_layout Enumerate
New code, tested only on min Energy and networks with two R and variably
 many N layers:
\end_layout

\begin_deeper
\begin_layout Enumerate
Deeper networks were better.
\end_layout

\begin_layout Enumerate
200 hidden units better than 100
\end_layout

\begin_layout Enumerate
lower z std (0.6) worked well, but higher z std also worked OK.
\end_layout

\end_deeper
\end_deeper
\begin_layout Enumerate

\series bold
(Done) Most meaningful loss so far seems to be
\series default
:
\begin_inset Formula 
\[
KL(p(x)\parallel\mu(x))+Shape(z)+Var_{1}(z_{scaled})
\]

\end_inset

Current best results: KL-loss 250.
 Std 
\begin_inset Formula $z$
\end_inset

: 1 (train) 1.3 (test).
 
\begin_inset Formula $N_{trans}\approx200$
\end_inset

.
 
\end_layout

\begin_layout Enumerate

\series bold
Reduce target variance
\series default
 for training data in order to account for increase of variance in test
 data.
\end_layout

\begin_layout Enumerate

\series bold
Reinforcement learning
\series default
: iterate (‚Äì> currently does not improve validation std_z.
 Revise protocol.):
\end_layout

\begin_deeper
\begin_layout Enumerate
Train with 
\begin_inset Formula $(\mathbf{x},\mathbf{w})$
\end_inset

 (initialized training data 
\begin_inset Formula $\mathbf{x}$
\end_inset

 from simulations in both endstates).
\end_layout

\begin_layout Enumerate
Generate new data 
\begin_inset Formula $\mathbf{x}^{*}$
\end_inset

 by sampling 
\begin_inset Formula $\mathbf{z}\sim\mathcal{N}(0,I)$
\end_inset

 (already happening in step ii, perhaps we can reuse it).
\end_layout

\begin_layout Enumerate
Run a few Metropolis steps to propagate 
\begin_inset Formula $\mathbf{x}^{*}\rightarrow\mathbf{x}^{**}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Replace or augment 
\begin_inset Formula $\mathbf{x}$
\end_inset

 by 
\begin_inset Formula $\mathbf{x}^{**}$
\end_inset

.
\end_layout

\end_deeper
\end_deeper
\begin_layout Enumerate

\series bold
Applications
\series default
:
\end_layout

\begin_deeper
\begin_layout Enumerate
Identical partical exchange in particle dimer: 
\series bold
Transferability issue
\series default
 ‚Äì training NICER network on one simulation and application to another leads
 to loss of overlap.
\end_layout

\begin_deeper
\begin_layout Enumerate

\series bold
(done) Hungarian method
\series default
: Using longer simulations and Hungarian method helps a lot.
 Using NICER network on an independent dataset is still not great but starts
 looking OK and monomodal in z.
 
\begin_inset Newline newline
\end_inset


\begin_inset Formula $\rightarrow$
\end_inset

 Works OK for short trajectories but not as well.
 Using longer trajectories now and storing data for quick recovery.
\end_layout

\begin_layout Enumerate

\series bold
(done) Data augmentation
\series default
: Check if we can get away by mixing all indices in the training data.
\begin_inset Newline newline
\end_inset


\begin_inset Formula $\rightarrow$
\end_inset

 Not trainable to good validation error.
 
\end_layout

\begin_layout Enumerate

\series bold
Test
\series default
: Check if initial shuffling (DA) of indices does not affect energies and
 training when used with Hungarian method, as expected.
 
\end_layout

\end_deeper
\begin_layout Enumerate
CG Fip35 System
\end_layout

\begin_deeper
\begin_layout Enumerate
Analyze Justin's data ‚Äì do we have everything to implement an energy and
 simulate it?
\end_layout

\begin_layout Enumerate
Try simulating it with MCMC.
 Can we observe folding/unfolding?
\end_layout

\begin_layout Enumerate
Apply NICER to this system
\end_layout

\end_deeper
\end_deeper
\begin_layout Enumerate

\series bold
Analysis
\series default
:
\end_layout

\begin_deeper
\begin_layout Enumerate

\series bold
Transition rates for particle system
\series default
: Approximate transition rates for particle system by changing the barrier
 height without changing the minima ‚Äì> 
\series bold
computing
\series default
.
\end_layout

\begin_layout Enumerate

\series bold
Run particle system training for different slope values
\series default
.
\end_layout

\begin_deeper
\begin_layout Enumerate
Write and run scripts.
\end_layout

\begin_layout Enumerate
Analyze and compare with available US results.
\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
Efficiency
\series default
: Find a way to compare efficiency of samplers.
 Number of independent samples?
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Equilibrium statistical mechanics is concerned with computing the average
 behavior of many copies of a physical system based on models of its microscopic
 constituents and their interactions.
 For example, what is the average magnetization in an Ising model of interacting
 magnetic spins in an external field, or what is the probability of a protein
 to be folded in an atomistic molecular model as a function of the temperature.
 Under a wide range of conditions, the equilibrium probability of a microscopic
 configuration 
\begin_inset Formula $\mathbf{x}$
\end_inset

 (setting of all spins, positions of all protein atoms, etc.) can be expressed
 by a Boltzmann-type distribution of the form
\begin_inset Formula 
\[
\mu(\mathbf{x})=\frac{1}{Z}\mathrm{e}^{-u(\mathbf{x})},
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $u(\mathbf{x})$
\end_inset

 is a dimensionless energy which contains the potential energy of the system,
 the temperature and optionally other thermodynamic quantities (SI).
 
\end_layout

\begin_layout Standard
Except for the simple model systems, such as the ideal gas or harmonic oscillato
rs, we presently neither know exact solutions for Boltzmann-weighted averages,
 nor ways to sample 
\begin_inset Formula $\mathbf{x}$
\end_inset

 directly from the Boltzmann distribution.
 Therefore, the generic simulation methods that are currently in use are
 essentially all variants of Markov-Chain Monte Carlo (MCMC) or Molecular
 Dynamics (MD) simulations that make tiny changes to 
\begin_inset Formula $\mathbf{x}$
\end_inset

 in each simulation step and will, over a long time, generate simulation
 trajectories that sample from the Boltzmann distribution.
 These methods suffer from rare events, i.e., many simulation steps are needed
 to transition between different phases or states ‚Äì for example, 
\begin_inset Formula $10^{9}-10^{15}$
\end_inset

 MD simulation steps are needed to fold or unfold a protein.
 As a result, these methods are extremely expensive and consume much of
 the worldwide supercomputing resources.
 Rare events transitions which can be traced by low-dimensional coordinates
 can be sped up by enhanced sampling methods 
\begin_inset CommandInset citation
LatexCommand cite
key "Torrie_JCompPhys23_187,Grubmueller_PhysRevE52_2893,LaioParrinello_PNAS99_12562"
literal "false"

\end_inset

, but the computational effort remains enourmous.
\end_layout

\begin_layout Standard
Ideally we would like to have a 
\begin_inset Quotes eld
\end_inset

Boltzmann Generator
\begin_inset Quotes erd
\end_inset

 machine that samples statistically independent configurations in 
\begin_inset Quotes eld
\end_inset

one-shot
\begin_inset Quotes erd
\end_inset

 from a known distribution 
\begin_inset Formula $p_{X}(\mathbf{x})$
\end_inset

 that is very similar to the Boltzmann distribution.
 If that could be achieved, we could use the ratio between 
\begin_inset Formula $p_{X}(\mathbf{x})$
\end_inset

 and the Boltzmann weight 
\begin_inset Formula $\mathrm{e}^{-u(\mathbf{x})}$
\end_inset

 to reweight each sample and compute any desired statistics.
 This enterprise seems, at first, hopeless for condensed-matter systems
 and complex polymers (e.g., Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:particle_dimer"
plural "false"
caps "false"
noprefix "false"

\end_inset

a, Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hydrocarbon"
plural "false"
caps "false"
noprefix "false"

\end_inset

k).
 In these systems, particles with strong repulsive interactions are densely
 packed in space, such that the number of 
\begin_inset Quotes eld
\end_inset

valid
\begin_inset Quotes erd
\end_inset

 configurations with a significant Boltzmann probability are vanishingly
 few compared to the number of possible ways to place particles.
 
\end_layout

\begin_layout Standard
Nonetheless, we directly address this problem in the present paper.
 Our strategy is: since constructing a Boltzmann Generator in configuration
 space is too difficult, can instead seek a coordinate transformation of
 
\begin_inset Formula $\mathbf{x}$
\end_inset

 to a so-called 
\begin_inset Quotes eld
\end_inset

latent
\begin_inset Quotes erd
\end_inset

 representation 
\begin_inset Formula $\mathbf{z}$
\end_inset

, in which sampling is easy and every sample can be back-transformed to
 a configuration 
\begin_inset Formula $\mathbf{x}$
\end_inset

 with a relevant Boltzmann weight.
 To find such a transformation, we employ deep learning that has recently
 led to breakthroughs in pattern recognition, games and autonomous control
 
\begin_inset CommandInset citation
LatexCommand cite
key "LeCunBengioHinton_DeepLearning_Nature05"
literal "false"

\end_inset

.
\end_layout

\begin_layout Section
Boltzmann Generators
\end_layout

\begin_layout Standard
Neural networks that can draw statistically independent samples from a desired
 distribution are called directed generative networks 
\begin_inset CommandInset citation
LatexCommand cite
key "GoodfellowEtAl_GANs,KingmaWelling_ICLR14_VAE"
literal "false"

\end_inset

.
 Such generative networks have been demonstrated to draw photorealistic
 images 
\begin_inset CommandInset citation
LatexCommand cite
key "KarrasEtAl_ProgressiveGrowingGANs"
literal "false"

\end_inset

, to produce deceivingly realistic speech audio 
\begin_inset CommandInset citation
LatexCommand cite
key "VanDenOord_WaveNet"
literal "false"

\end_inset

, 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Is this really a generative network?
\end_layout

\end_inset

and even to sample formulae of chemical compounds with certain physico-chemical
 properties 
\begin_inset CommandInset citation
LatexCommand cite
key "GomezBombarelli_ACSCentral_AutomaticDesignVAE"
literal "false"

\end_inset

.
 In these domains, the exact target distribution is not known and must be
 inferred by observing many examples, which explains why the approach works
 best when large datasets are available.
 Here we are in the inverse situation, as we want to avoid having to train
 the Boltzmann Generator with samples 
\begin_inset Formula $\mathbf{x}$
\end_inset

 from the Boltzmann distribution, as these are difficult to generate.
 However, we have the great advantage that the Boltzmann distribution is
 known up to constant factor, such that the weight of each generated sample
 can be evaluated and used in the training procedure.
 
\end_layout

\begin_layout Standard
The idea of Boltzmann Generators is as follows: we want to learn a neural
 network transformation 
\begin_inset Formula $F_{zx}$
\end_inset

 such that when sampling from a simple distribution in 
\begin_inset Formula $\mathbf{z}$
\end_inset

, such as a standard normal distribution, 
\begin_inset Formula $F_{zx}(\mathbf{z})$
\end_inset

 will provide a Boltzmann-distributed configuration 
\begin_inset Formula $x$
\end_inset

:
\begin_inset Formula 
\[
p_{Z}(\mathbf{z})=\mathcal{N}\left(0,\tau\mathbf{I}\right)\overset{^{\mathrm{sample}}}{\sim}\mathbf{z}\overset{F_{zx}}{\longrightarrow}\mathbf{x}\overset{^{\mathrm{sample}}}{\sim}p_{X}(\mathbf{x})\propto\mathrm{e}^{-u(\mathbf{x})/\tau}.
\]

\end_inset

Here, 
\begin_inset Formula $\mathcal{N}\left(0,\tau\mathbf{I}\right)$
\end_inset

 indicates the normal distribution with variance 
\begin_inset Formula $\tau$
\end_inset

 and 
\begin_inset Formula $\mathrm{e}^{-u(\mathbf{x})/\tau}$
\end_inset

 is a Boltzmann distribution at temperature 
\begin_inset Formula $\tau$
\end_inset

 (SI).
\end_layout

\begin_layout Standard
In general, we will sample from the Boltzmann distribution exactly, and
 in some cases we may even want to deviate from that goal, for example in
 order to sample certain high-energy states with a higher probability.
 In order to both train the Boltzmann Generator and subsequently reweight
 its samples to the Boltzmann distribution, it is important that we can
 quantify the distribution 
\begin_inset Formula $p_{X}(\mathbf{x})$
\end_inset

 that is generated by the network at all times.
 This can be achieved when 
\begin_inset Formula $F_{zx}$
\end_inset

 is invertible: For invertible transformations, we can not only back-compute
 
\begin_inset Formula $\mathbf{z}=F_{zx}^{-1}(\mathbf{x})=F_{xz}(\mathbf{x})$
\end_inset

, but we can also compute 
\begin_inset Formula $p_{X}(\mathbf{x})$
\end_inset

 from the known 
\begin_inset Formula $p_{Z}(\mathbf{z})$
\end_inset

 and 
\begin_inset Formula $F_{xz}$
\end_inset

 (SI).
\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/network_structure2.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig_network-architecture"

\end_inset


\series bold
Boltzmann Generator network architecture.

\series default
 
\series bold
a)
\series default
 Nonlinear transformations 
\begin_inset Formula $T$
\end_inset

 and 
\begin_inset Formula $S$
\end_inset

 are built with multilayer neural networks.
 
\series bold
b,c)
\series default
 Volume-preserving NICE layer and its inverse.
 
\series bold
d,e)
\series default
 Non-volume-preserving RealNVP layer and its inverse.
 
\series bold
f)
\series default
 Stacking any sequence of these layers with channels exchanges produces
 the full Boltzmann Generator, and invertible network.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Invertible neural network transformations are similar to flows of a fluid
 ‚Äì an incompressible fluid when using the NICE layers 
\begin_inset CommandInset citation
LatexCommand cite
key "DinhDruegerBengio_NICE2015"
literal "false"

\end_inset

 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_network-architecture"
plural "false"
caps "false"
noprefix "false"

\end_inset

b) and a compressible fluid when using the RealNVP layers 
\begin_inset CommandInset citation
LatexCommand cite
key "DinhBengio_RealNVP"
literal "false"

\end_inset

 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_network-architecture"
plural "false"
caps "false"
noprefix "false"

\end_inset

e).
 Invertibility is achieved by splitting the variables into two or more channels,
 performing only simple, invertible operations on each of them, such as
 translations (T) and scaling (S) operations (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_network-architecture"
plural "false"
caps "false"
noprefix "false"

\end_inset

c,e).
 Nonlinear operations acting between the channels define the T/S operations.
 These are represented by general neural networks that do not need to be
 inverted themselves (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_network-architecture"
plural "false"
caps "false"
noprefix "false"

\end_inset

a).
 The NICE or RealNVP layers can be stacked to form a deep neural network
 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_network-architecture"
plural "false"
caps "false"
noprefix "false"

\end_inset

f).
 The resulting flow transformation can be trained to represent any continuous
 nonlinear variable transformation, and it is yet fully invertible (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_network-architecture"
plural "false"
caps "false"
noprefix "false"

\end_inset

f).
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Symbols: We have used 
\begin_inset Formula $S$
\end_inset

 and 
\begin_inset Formula $T$
\end_inset

 for the nonlinear transformations in the NN.
 Then it is confusing to also use 
\begin_inset Formula $T$
\end_inset

 (
\begin_inset Formula $T_{xy}/T_{yx}$
\end_inset

) for the whole network.
 Maybe 
\begin_inset Formula $F$
\end_inset

?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In other application areas, invertible networks are trained with maximum
 likelihood (ML) 
\begin_inset CommandInset citation
LatexCommand cite
key "DinhDruegerBengio_NICE2015"
literal "false"

\end_inset

.
 Following this idea, we would use some initial simulation data, e.g.
 short MD simulations in one or a few metastable states, that are not (yet)
 Boltzmann distributed as an input.
 Then we train 
\begin_inset Formula $F_{xz}$
\end_inset

 such that 
\begin_inset Formula $z$
\end_inset

 will be distributed according to a Gaussian.
 This can be done by sampling configurations 
\begin_inset Formula $\mathbf{x}$
\end_inset

 from the input data, transforming each of them to the latent space by 
\begin_inset Formula $\mathbf{z}=F_{xz}(\mathbf{x})$
\end_inset

, and minimizing the likelihood loss: 
\begin_inset Formula 
\begin{equation}
J_{ML}=\mathbb{E}_{\mathbf{x}}\left[u_{Z}\left(F_{xz}(\mathbf{x})\right)-S_{xz}(\mathbf{x})\right].\label{eq:main_loss_ML}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Here, 
\begin_inset Formula $u_{Z}$
\end_inset

 is the 
\begin_inset Quotes eld
\end_inset

energy
\begin_inset Quotes erd
\end_inset

 of the latent space distribution, which is simple a harmonic oscillator
 energy when using a Gaussian distribution in 
\begin_inset Formula $\mathbf{z}$
\end_inset

.
 
\begin_inset Formula $S_{xz}$
\end_inset

 quantifies how much the network scales the configuration space volume at
 
\begin_inset Formula $\mathbf{x}$
\end_inset

 and can be computed from the scaling transformations of the network (SI).
 
\begin_inset Formula $S_{xz}$
\end_inset

 is zero for volume-preserving NICE layers.
 
\end_layout

\begin_layout Standard
The unique capability of Boltzmann Generators is that they can also be trained
 in the reverse direction: We sample Gaussian normal variables 
\begin_inset Formula $\mathbf{z}$
\end_inset

, transform them through the network 
\begin_inset Formula $T_{zx}$
\end_inset

 and try to minimize the difference between the generated distribution and
 the Boltzmann distribution.
 This leads to minimizing the following loss, which has the same principal
 form:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
J_{KL}=\mathbb{E}_{\mathbf{z}\sim q_{Z}(\mathbf{z})}\left[u_{X}(F_{zx}(\mathbf{z}))-S_{zx}(\mathbf{z})\right]\label{eq:main_loss_KL}
\end{equation}

\end_inset

In both (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:main_loss_ML"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:main_loss_KL"
plural "false"
caps "false"
noprefix "false"

\end_inset

), the first term is minimizing the mean potential energy, i.e.
 the enthalpy of the system, and the second term is maximizing the entropy
 of the transformation, which avoids that the network only learns to sample
 the minimum energy configuration.
 Still, minimizing only 
\begin_inset Formula $J_{KL}$
\end_inset

 tends to focus sampling on the most stable metastable state (Suppl.
 Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_training_methods_NICER"
plural "false"
caps "false"
noprefix "false"

\end_inset

,
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_training_methods_RealNVP"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 We found it beneficial to combine both losses, in particular it is useful
 to start the training by minimizing 
\begin_inset Formula $J_{ML}$
\end_inset

 using a small set of simulation data in order to initialize 
\begin_inset Formula $T_{zx}$
\end_inset

 to point to the relevant part of state space.
 Finally, it may not always be desired to sample according to the Boltzmann
 distribution, for example when we want to sample transition states with
 low probability.
 For this reason, we introduce an additional loss term that enhances sampling
 along specific coordinates called reaction coordinate (RC) loss and that
 will be used for certain applications (SI).
 
\end_layout

\begin_layout Section
Results
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Aim for this part
\series default
:
\end_layout

\begin_layout Plain Layout
- Illustrate how Boltzmann generators work
\end_layout

\begin_layout Plain Layout
- Show that 1D-free energies can be sampled without rare event problems
\end_layout

\end_inset


\end_layout

\begin_layout Standard
We first illustrate Boltzmann Generators using a two-dimensional potential
 that has two stable states in 
\begin_inset Formula $x_{1}$
\end_inset

-direction separated by a high energy barrier, while it is a harmonic oscillator
 in 
\begin_inset Formula $x_{2}$
\end_inset

 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

a).
 MD simulations will oscillate close to one of the stable state for a long
 time before a rare transition event occurs (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

b).
 Hence, the distribution in configuration space 
\begin_inset Formula $(x,y)$
\end_inset

 is split into two modes (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

c, transition state ensemble is shown in yellow for clarity but not used
 for training).
 We are training Boltzmann Generators using the two short simulations shown
 in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

b as input, either by just minimizing (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:main_loss_KL"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:main_loss_ML"
plural "false"
caps "false"
noprefix "false"

\end_inset

) or with additional RC loss, which adds a term to promote sampling along
 
\begin_inset Formula $x_{1}$
\end_inset

 (SI).
 Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

d,e show the latent space learned by non-volume-preserving and a volume-preservi
ng transformation, respectively.
 In both cases, the probability densities of the two states and the transition
 state are 
\begin_inset Quotes eld
\end_inset

repacked
\begin_inset Quotes erd
\end_inset

 so as to form a compact density close to the center.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
The flow field shown in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

f shows how the volume-preserving transformation 
\begin_inset Formula $T_{zx}$
\end_inset

 
\begin_inset Quotes eld
\end_inset

unpacks
\begin_inset Quotes erd
\end_inset

 the latent density into the two-state configuration density (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

e
\begin_inset Formula $\rightarrow$
\end_inset

c).
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
We use the Boltzmann generator by sampling from its latent space according
 to the Gaussian distribution.
 After transforming these variables via 
\begin_inset Formula $T_{zx}$
\end_inset

, this produces uncorrelated samples from both stable states without any
 sampling problem.
 A variety of training methods (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:main_loss_KL"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:main_loss_ML"
plural "false"
caps "false"
noprefix "false"

\end_inset

) succeed in sampling across the barrier such that the rare event nature
 of the system is eliminated (SI).
 Using simple reweighting, this procedure reproduces the precise free energy
 differences of the two metastable states (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

g green).
 By additionally training with the RC loss, the low-probability transition
 states are sampled (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

f orange), and reconstruct the full free energy profile along 
\begin_inset Formula $x_{1}$
\end_inset

 can be reconstructed with high precision (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

f,g orange).
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
TODO
\series default
: Also show/describe Latent MCMC?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/Fig_Results_DoubleWell.pdf
	lyxscale 80
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:double_well"

\end_inset


\series bold
Illustration of Boltzmann Generators for two-dimensional bistable system.

\series default
 
\series bold
a)
\series default
 Two-dimensional potential, 
\begin_inset Formula $x_{1}$
\end_inset

 is the slow coordinate.
 
\series bold
b)
\series default
 Distribution of training data in 
\begin_inset Formula $x$
\end_inset

-space and in 
\begin_inset Formula $z$
\end_inset

-space after training.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
c) Transformation flow of the neural network 
\begin_inset Formula $T_{zx}$
\end_inset

.
 
\end_layout

\end_inset


\series bold
c)
\series default
 Distribution of trajectories of b) in configuration space 
\begin_inset Formula $(x_{1},x_{2})$
\end_inset

.
 Transition state ensemble is shown (orange) but not used for training.
 
\series bold
d,e)
\series default
 Latent-space distribution of trajectories of b) when mapped through 
\begin_inset Formula $F_{xz}$
\end_inset

 using non-volume preserving (d) and volume-preserving (e) transformations.
 
\series bold
f)
\series default
 Free energy corresponding to distribution sampled by Boltzmann Generators
 trained mainly with Eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:main_loss_KL"
plural "false"
caps "false"
noprefix "false"

\end_inset

) (green) and using reaction coordinate training (orange).
 
\series bold
g)
\series default
 Free energy estimates obtained after reweighting, colors as in (f).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Aim for this part
\series default
:
\end_layout

\begin_layout Plain Layout
- Show that Boltzmann generators can sample structures and thermodynamics
 in condensed matter systems.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
As a second example, we demonstrate that Boltzmann Generators can sample
 high-probability structures and efficiently compute the thermodynamics
 in crowded condensed matter systems.
 For this we simulated a dense system of two-dimensional particles confined
 to a box as suggested in 
\begin_inset CommandInset citation
LatexCommand cite
key "NilmeyerEtAl_PNA11_NCMC"
literal "false"

\end_inset

 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:particle_dimer"
plural "false"
caps "false"
noprefix "false"

\end_inset

a).
 Particles repel each other with the 
\begin_inset Formula $12^{th}$
\end_inset

 power of their inverse distance when being close.
 A bistable particle dimer is immersed in the fluid.
 The open and closed states of the dimer are separated by a high barrier
 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:particle_dimer"
plural "false"
caps "false"
noprefix "false"

\end_inset

a-c).
 Directly opening or closing the dimer is not possible due to the high density
 of the system and requires a concerted rearrangement of the solvent particles.
 As a result of this setup, this system's low-energy/high-probability states
 are organized on a complex and thin nonlinear manifold in the 76-dimensional
 configuration space - almost every vector of length 76 corresponds to a
 physically unrealistic configuration as clashing particles immediately
 cause gigantic potential energies and thus vanishing probabilities.
 Designing a sampling method by hand that would simultaneously place all
 
\begin_inset Formula $38$
\end_inset

 particles and achieve low energies and appears unfeasible.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Would be nice to illustrate how simple-minded configuration generation results
 in energies that are orders of magnitude too high.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Make sure that it is understood that the main ingredient to training is
 the energy.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
We train a Boltzmann Generator to sample valid one-shot configurations with
 low energy and use it in order to compute the free energy profiles of opening
 / closing the dimer.
 The training is initialized with separate, disconnected simulations of
 the open and closed states, but in later stages, mostly the 
\begin_inset Formula $\mathrm{KL}$
\end_inset

-loss (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:main_loss_KL"
plural "false"
caps "false"
noprefix "false"

\end_inset

) is used, i.e.
 training is guided by the potential energy function that defines the system
 (SI).
 A restraint keeps the bistable particle dimer centered and aligned in the
 simulation box, therefore the 
\begin_inset Formula $x$
\end_inset

-position of each dimer particle indicates if we are in the open or closed
 state (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:particle_dimer"
plural "false"
caps "false"
noprefix "false"

\end_inset

d).
 The trained Boltzmann Generator has learned a transformation of the complex
 configuration space density to a compact, 76-dimensional ball in latent
 space (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:particle_dimer"
plural "false"
caps "false"
noprefix "false"

\end_inset

e).
 Direct sampling of from 76-dimensional Gaussian in latent space and transformat
ion via 
\begin_inset Formula $T_{zx}$
\end_inset

 not only generates realistically looking configurations where all particles
 are placed without significant clashes, but also samples potential energies
 that overlap with the energy distribution of MD trajectories started in
 open and closed states (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:particle_dimer"
plural "false"
caps "false"
noprefix "false"

\end_inset

f-h).
 The sampling procedure generates open and closed states without any rare
 event sampling problem and also produces realistic transition states that
 have not been included in any training data (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:particle_dimer"
plural "false"
caps "false"
noprefix "false"

\end_inset

g).
 
\end_layout

\begin_layout Standard
In order to demonstrate that thermodynamic quantities can be computed with
 Boltzmann Generators, we conduct the training using the 
\begin_inset Formula $\mathrm{KL}$
\end_inset

 loss (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:main_loss_KL"
plural "false"
caps "false"
noprefix "false"

\end_inset

) simultaneously to a range of temperatures between one fourth and four
 times the reference temperature.
 For this training we exploit that the temperature, which changes the configurat
ion space distribution in a complex way, simply enters as a scaling factor
 in the width of the Gaussian in latent space (SI).
 Then, we sample the Boltzmann Generator for a range of temperatures and
 use simple reweighting to compute the free energies along the dimer distances.
 As shown in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:particle_dimer"
plural "false"
caps "false"
noprefix "false"

\end_inset

i, these temperature-dependent free energies agree precisely with extensive
 umbrella sampling simulations that employ bias potentials along the dimer
 distance 
\begin_inset CommandInset citation
LatexCommand cite
key "Torrie_JCompPhys23_187"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/Fig_Results_Particles.pdf
	lyxscale 70
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:particle_dimer"

\end_inset


\series bold
Particle System with bistable dimer.

\series default
 
\series bold
a,b)
\series default
 Closed (blue) and open (red) configurations from MD simulations (input
 data).
 
\series bold
c)
\series default
 Bistable dimer potential.
 
\series bold
d)
\series default
 Distribution of input data on 
\begin_inset Formula $x_{1},x_{2}$
\end_inset

.
 e) Distribution of input data on 
\begin_inset Formula $z_{1},z_{2}$
\end_inset

 after training.
 
\series bold
f, g, h)
\series default
 Potential energy distribution from MD (colored) and Boltzmann generator
 (grey) for closed (f), open (h) and transition configurations (g).
 Insets show one-shot samples from Boltzmann generator.
 
\series bold
i)
\series default
 Free energy differences as a function of dimer distance and temperature
 sampled with Boltzmann generators (one-shot generation and reweighting,
 bullets with error bars indicating one standard deviation) and umbrella
 sampling (green lines).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Aim for this part
\series default
:
\end_layout

\begin_layout Plain Layout
- Show that Boltzmann generators can sample complex polymer structures.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Finally, we demonstrate that Boltzmann Generators can sample complex polymer
 structures.
 Cyclical polymers are especially challening, because for each change of
 a torsion angle, other torsion angles must be changed so as to maintain
 ring closure and all bond angle constraints.
 Sophisticated Monte Carlo moves have been designed for this purpose 
\begin_inset CommandInset citation
LatexCommand cite
key "GoScheraga_Macromolecules70_RingClosure"
literal "false"

\end_inset

, but they are so complex that calculating the Jacobian of the transformation
 is likely untractable, and it is thus unknown how to construct an MCMC
 procedure that would sample the Boltzmann distribution.
 Sampling thus relies on standard methods, such as replica-exchange MD that
 is used here in order to generate initial and reference data.
\end_layout

\begin_layout Standard
With Boltzmann Generators, valid low-energy structures of cyclical hydrocarbons
 can be generated in one shot.
 Using a short replica-exchange MD simulation of cyclononane (
\begin_inset Formula $C_{9}H_{18}$
\end_inset

) as input in which 4 distinct rotamers have been sampled, one-shot samples
 from the Boltzmann Generator produce structures with both known and new
 rotamers (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hydrocarbon"
plural "false"
caps "false"
noprefix "false"

\end_inset

a, e-j).
 Potential energies over generated structures have a high overlap with the
 potential energy sampled in the MD simulation (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hydrocarbon"
plural "false"
caps "false"
noprefix "false"

\end_inset

b).
 Note that all atoms ‚Äì including hydrogens ‚Äì are generated in one shot.
 Nontheless, the bond lengths and bond angles follow their equilibrium distribut
ion closely (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hydrocarbon"
plural "false"
caps "false"
noprefix "false"

\end_inset

c,d).
 
\end_layout

\begin_layout Standard
Finally, one-shot samples were generated for bicyclo[4.4.4]tetradecane 
\begin_inset Formula $C_{14}H_{26}$
\end_inset

, a highly constrained and densely packed hydrocarbone with two interconnected
 ring systems and 120 dimensions (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hydrocarbon"
plural "false"
caps "false"
noprefix "false"

\end_inset

k,l and insets).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/Fig_Results_Hydrocarbons.pdf
	lyxscale 70
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:hydrocarbon"

\end_inset


\series bold
One-shot sampling of cyclical molecule structures
\series default
: Cyclononane 
\begin_inset Formula $C_{9}H_{18}$
\end_inset

 (a-j) and bicyclo[4.4.4]tetradecane 
\begin_inset Formula $C_{14}H_{26}$
\end_inset

 (k-l).
 
\series bold
a)
\series default
 Number of distinct rotamers samples with Boltzmann Generator that is initialize
d with MD data containing 12 rotamers.
 
\series bold
b)
\series default
 Potential energy distribution.
 
\series bold
c-d)
\series default
 Generated bond length and angle distribution compared to MD data.
 
\series bold
e-g)
\series default
 One-shot Boltzmann-generated structures and the most similar MD structures
 with free energies estimated from replica-exchange MD (red) and Boltzmann
 Generator (black).
 
\series bold
h-j)
\series default
 One-shot Boltzmann-generated structures that are not contained in the MD
 simulations, along with free energy estimates.
 k-l) One-shot Boltzmann-generated structures of bicyclo[4.4.4]tetradecane
 
\begin_inset Formula $C_{14}H_{26}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Conclusions
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Boltzmann Generators are, as yet, the first approach that can sample the
 Boltzmann distribution and generate structures of condensed matter systems
 and complex polymers directly, i.e.
 by avoiding to make small MD or MCMC steps.
 We have demonstrated this for systems with up to about hundred dimensions.
 Although we expect the methodology to improve futher, we do not expect
 one-shot sampling to scale to systems of 100,000's of dimensions, such
 as atomistic models of proteins in solution.
 The present approach could still be applied to these systems by executing
 cluster Monte Carlo moves, i.e.
 by grouping the system into clusters of atoms and re-sample them according
 to their marginal distribution in the environment of the remaining system.
\end_layout

\begin_layout Standard
The present work shows that Boltzmann Generators can sample the Boltzmann
 distribution of complex systems in one shot and may offer a way out of
 the sampling problem in condensed matter systems.
 The limitation of the current work is that the transformation that achieves
 this needs to be trained using the system-specific energy.
 In order to make the approach general, it needs to be transferable across
 systems, and a promising route is the transferable machine learning practiced,
 e.g., in Quantum Machine Learning 
\begin_inset CommandInset citation
LatexCommand cite
key "BehlerParrinello_PRL07_NeuralNetwork,RuppEtAl_PRL12_QML"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "/Users/noe/data/my_papers/bib/all,/Users/noe/data/my_papers/bib/own"
options "plain"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
clearpage
\end_layout

\end_inset


\end_layout

\begin_layout Section*
Supplementary Material
\end_layout

\begin_layout Subsection*
A.
 Invertible networks
\end_layout

\begin_layout Standard
We employ invertible networks in order to learn the transformation between
 the Gaussian random variables 
\begin_inset Formula $\mathbf{z}$
\end_inset

 and the Boltzmann-distributed random variables 
\begin_inset Formula $\mathbf{x}$
\end_inset

:
\begin_inset Formula 
\begin{align*}
\mathbf{z} & =F_{xz}(\mathbf{x};\boldsymbol{\theta})\\
\mathbf{x} & =F_{zx}(\mathbf{z};\boldsymbol{\theta}).
\end{align*}

\end_inset

Hence 
\begin_inset Formula $T_{xz}=T_{zx}^{-1}$
\end_inset

.
 Note that the set of parameters 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 defining these transformations are identical (shared) between the forward
 and backward transformations.
 Each transformation has a Jacobian matrix with the pairwise first derivatives
 of outputs with respect to inputs:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mathbf{J}_{zx}(\mathbf{z};\boldsymbol{\theta}) & =\left[\frac{\partial F_{zx}(\mathbf{z};\boldsymbol{\theta})}{\partial z_{1}},...,\frac{\partial F_{zx}(\mathbf{z};\boldsymbol{\theta})}{\partial z_{n}}\right]\\
\mathbf{J}_{xz}(\mathbf{x};\boldsymbol{\theta}) & =\left[\frac{dF_{xz}(\mathbf{x};\boldsymbol{\theta})}{dx_{1}},...,\frac{dF_{xz}(\mathbf{x};\boldsymbol{\theta})}{dx_{n}}\right]
\end{align*}

\end_inset

The absolute value of the Jacobian's determinant, 
\begin_inset Formula $\left|\det\mathbf{J}_{zx}(\mathbf{z};\boldsymbol{\theta})\right|$
\end_inset

, measures how much a volume element at 
\begin_inset Formula $\mathbf{z}$
\end_inset

 is scaled by the transformation.
 Forward and reverse transformation are related by 
\begin_inset Formula $\left|\det\mathbf{J}_{zx}(\mathbf{z};\boldsymbol{\theta})\right|=\left|\det\mathbf{J}_{xz}(\mathbf{x})\right|^{-1}$
\end_inset

, and respectively for 
\begin_inset Formula $\mathbf{x}$
\end_inset

 and 
\begin_inset Formula $\mathbf{z}$
\end_inset

 exchanged.
 As we frequently deal with logarithms of Jacobian determinants, we introduce
 the abbreviations:
\begin_inset Formula 
\begin{align*}
S_{xz}(\mathbf{x}) & =\log\left|\det\mathbf{J}_{xz}(\mathbf{x})\right|\\
S_{zx}(\mathbf{z}) & =\log\left|\det\mathbf{J}_{zx}(\mathbf{z})\right|.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Our main motivation to use invertible transformations is that they allow
 us to transform random variables as follows:
\begin_inset Formula 
\begin{align}
p_{X}(\mathbf{x}) & =p_{Z}(\mathbf{z})\left|\det\mathbf{J}_{zx}(\mathbf{z})\right|^{-1}\nonumber \\
 & =p_{Z}(T_{xz}(\mathbf{x}))\left|\det\mathbf{J}_{xz}(\mathbf{x})\right|\label{eq:transform_zx}\\
p_{Z}(\mathbf{z}) & =p_{X}(\mathbf{x})\left|\det\mathbf{J}_{xz}(\mathbf{x})\right|^{-1}\nonumber \\
 & =p_{X}(T_{zx}(\mathbf{z}))\left|\det\mathbf{J}_{zx}(\mathbf{z})\right|\label{eq:transform_xz}
\end{align}

\end_inset

Here we employ the invertible network structures NICE 
\begin_inset CommandInset citation
LatexCommand cite
key "DinhDruegerBengio_NICE2015"
literal "false"

\end_inset

 and RealNVP 
\begin_inset CommandInset citation
LatexCommand cite
key "DinhBengio_RealNVP"
literal "false"

\end_inset

.
 The main idea is to split the variables into two channels, 
\begin_inset Formula $\mathbf{x}=(\mathbf{x}_{1},\mathbf{x}_{2})$
\end_inset

 and 
\begin_inset Formula $\mathbf{z}=(\mathbf{z}_{1},\mathbf{z}_{2})$
\end_inset

, do only trivially invertible operations on each channel, such as multiplicatio
n and addition, and use trainable, nonlinear neural network transformations
 between the channels to compute the value of these multiplication and addition
 transformations.
 
\end_layout

\begin_layout Standard
Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Invertible-network-components"
plural "false"
caps "false"
noprefix "false"

\end_inset

 summarizes the transformations employed here, their inverses and Jacobian
 determinant values.
 A single transformation of 
\begin_inset Formula $(\mathbf{z}_{1},\mathbf{z}_{2})=f_{xz}(\mathbf{x}_{1},\mathbf{x}_{2})$
\end_inset

, where 
\begin_inset Formula $T_{xz}$
\end_inset

 is implement via NICE or RealNVP transforms only the second channel and
 leaves the first channel unchanged.
 In order to allow all variables to be transformed, we swap channels in
 the next transformation, and define a NICE or RealNVP block as:
\begin_inset Formula 
\begin{align*}
(\mathbf{y}_{1},\mathbf{y}_{2}) & =f_{xy}(\mathbf{x}_{1},\mathbf{x}_{2})\\
(\mathbf{z}_{1},\mathbf{z}_{2}) & =f_{yz}(\mathbf{y}_{2},\mathbf{y}_{1})
\end{align*}

\end_inset

Boltzmann Generators are build by putting the forward and the inverse of
 such blocks in parallel (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_network-architecture"
plural "false"
caps "false"
noprefix "false"

\end_inset

f).
 The forward and the inverse transformation in each layer share the same
 nonlinear transformation (
\begin_inset Formula $T$
\end_inset

 or 
\begin_inset Formula $S$
\end_inset

), and therefore the same parameters.
\end_layout

\begin_layout Standard
The NICE transformation is volume-preserving.
 As such, it also preserves the entropy 
\begin_inset Formula $H_{X}=\int p(\mathbf{x})\log p(\mathbf{x})\:\mathrm{d}\mathbf{x}$
\end_inset

.
 In order to be able to model probability distributions with arbitrary entropy,
 we need to insert at least one scaling layer into a Boltzmann Generator
 that otherwise only contains NICE layers.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="1.5cm">
<column alignment="left" valignment="top" width="4.5cm">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top" width="4.5cm">
<column alignment="left" valignment="top" width="0pt">
<row topspace="0.2cm" bottomspace="0.2cm">
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Layer
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f_{xz}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left|\det\mathbf{J}_{xz}\right|$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f_{zx}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left|\det\mathbf{J}_{zx}\right|$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row topspace="0.2cm" bottomspace="0.2cm">
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NICE
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{cl}
\mathbf{z}_{1}= & \mathbf{x}_{1}\\
\mathbf{z}_{2}= & \mathbf{x}_{2}+T(\mathbf{x}_{1};\boldsymbol{\theta})
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{cl}
\mathbf{x}_{1} & =\mathbf{z}_{1}\\
\mathbf{x}_{2} & =\mathbf{z}_{2}-T(\mathbf{y}_{1};\boldsymbol{\theta})
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row topspace="0.2cm" bottomspace="0.2cm">
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Scaling, Exp
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hspace{0.2cm}
\end_layout

\end_inset


\begin_inset Formula $\mathbf{z}=\mathrm{e}^{\mathbf{k}}\circ\mathbf{x}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{e}^{\sum_{i}k_{i}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hspace{0.2cm}
\end_layout

\end_inset


\begin_inset Formula $\mathbf{x}=\mathrm{e}^{-\mathbf{k}}\circ\mathbf{z}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{e}^{-\sum_{i}k_{i}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row topspace="0.2cm" bottomspace="0.2cm">
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RealNVP
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{cl}
\mathbf{z}_{1} & =\mathbf{x}_{1}\\
\mathbf{z}_{2} & =\mathbf{x}_{2}\odot\exp\left(S(\mathbf{x}_{1};\boldsymbol{\theta})\right)\\
 & \:\:\:+T(\mathbf{x}_{1};\boldsymbol{\theta})
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{e}^{\sum_{i}S_{i}(\mathbf{x}_{1};\boldsymbol{\theta})}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{cl}
\mathbf{x}_{1} & =\mathbf{z}_{1}\\
\mathbf{x}_{2} & =\left(\mathbf{z}_{2}-T(\mathbf{x}_{1};\boldsymbol{\theta})\right)\\
 & \:\:\:\odot\exp\left(-S(\mathbf{z}_{1};\boldsymbol{\theta})\right)
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{e}^{-\sum_{i}S_{i}(\mathbf{z}_{1};\boldsymbol{\theta})}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Invertible-network-components"

\end_inset

Invertible network components.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
B.
 Training Boltzmann Generators
\end_layout

\begin_layout Standard
The Boltzmann Generator is trained by minimizing a loss functional that
 has the following form:
\begin_inset Formula 
\[
J=w_{ML}J_{ML}+w_{KL}J_{KL}+w_{RC}J_{RC}.
\]

\end_inset

where the terms represent maximum-likelihood (ML), Kullback-Leiber (KL)
 or relative entropy, and reaction-coordinate (RC) optimization and the
 
\begin_inset Formula $w$
\end_inset

's control their weights.
 Below we will derive these terms in detail.
 
\end_layout

\begin_layout Standard
We call the prior distribution injected into the latent space 
\begin_inset Formula $q_{Z}(\mathbf{z})$
\end_inset

 and the Boltzmann distribution in the configuration space 
\begin_inset Formula $\mu_{X}(\mathbf{x})$
\end_inset

.
 The generated distributions are then called 
\begin_inset Formula $p$
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
q_{Z}(\mathbf{z}) & \overset{F_{zx}}{\longrightarrow} & p_{X}(\mathbf{x})\\
\mu_{X}(\mathbf{x}) & \overset{F_{xz}}{\longrightarrow} & p_{Z}(\mathbf{z})
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard

\series bold
Boltzmann distribution
\series default
: We aim at sampling configurations 
\begin_inset Formula $\mathbf{x}$
\end_inset

 from the Boltzmann distribution
\begin_inset Formula 
\begin{equation}
\mu_{X}(\mathbf{x})=Z_{X}^{-1}\mathrm{e}^{-\beta U(\mathbf{x})}\label{eq:Boltzmann_distribution}
\end{equation}

\end_inset

where 
\begin_inset Formula $\beta^{-1}=k_{B}T$
\end_inset

 with Boltzmann constant 
\begin_inset Formula $k_{B}$
\end_inset

 and temperature 
\begin_inset Formula $T$
\end_inset

.
 When we only have one temperature, we can simply subsume the constant into
 a reduced energy
\begin_inset Formula 
\[
u(\mathbf{x})=\frac{U(\mathbf{x})}{k_{B}T}
\]

\end_inset

In order to evaluate a set of temperatures 
\begin_inset Formula $(T^{1},...,T^{K})$
\end_inset

, we can define a reference temperature 
\begin_inset Formula $T^{0}$
\end_inset

 and the respective reduced energy 
\begin_inset Formula $u^{0}(\mathbf{x})=U(\mathbf{x})/k_{B}T^{0}$
\end_inset

 and we then obtain the reduced energies simply by scaling:
\begin_inset Formula 
\[
u^{k}(\mathbf{x})=\frac{T^{0}}{T^{k}}u^{0}(\mathbf{x})=\frac{u^{0}(\mathbf{x})}{\tau_{k}}
\]

\end_inset

where 
\begin_inset Formula $\tau_{k}$
\end_inset

 is the relative temperature.
\end_layout

\begin_layout Standard

\series bold
Prior distribution
\series default
: We sample the input in 
\begin_inset Formula $\mathbf{z}$
\end_inset

 from the isotropic Gaussian distribution:
\begin_inset Formula 
\begin{equation}
q_{Z}^{k}(\mathbf{z})=\mathcal{N}(\mathbf{0},\sigma_{k}^{2}\mathbf{I})=Z_{Z}^{-1}\mathrm{e}^{-\frac{1}{2}\left\Vert \mathbf{z}\right\Vert ^{2}/\sigma_{k}^{2}},\label{eq:z_Gaussian_prior}
\end{equation}

\end_inset

with normalization constant 
\begin_inset Formula $Z_{Z}$
\end_inset

.
 The prior energy, i.e.
 the energy whose Boltzmann distribution is the prior distribution, is given
 by: 
\begin_inset Formula 
\begin{align}
u_{Z}^{k}(\mathbf{z}) & =-\log q_{Z}^{k}(\mathbf{z})\nonumber \\
 & =\frac{1}{2\sigma_{k}^{2}}\left\Vert \mathbf{z}\right\Vert ^{2}+\mathrm{const}.\label{eq:z_Gaussian_energy}
\end{align}

\end_inset

Thus the variance takes the same role as the relative temperature.
 We define (arbitrarily) to set the variance equal 1 at the standard temperature
, and obtain: 
\begin_inset Formula 
\[
\sigma_{k}^{2}=\tau_{k}.
\]

\end_inset


\end_layout

\begin_layout Paragraph
Latent KL divergence
\end_layout

\begin_layout Standard
The KL divergence between two distributions 
\begin_inset Formula $q$
\end_inset

 and 
\begin_inset Formula $p$
\end_inset

 is given by
\begin_inset Formula 
\begin{align*}
\mathrm{KL}(q\parallel p) & =\int q(\mathbf{x})\left[\log q(\mathbf{x})-\log p(\mathbf{x})\right]\mathrm{d}\mathbf{x},\\
 & =H_{q}-\int q(\mathbf{x})\log p(\mathbf{x})\mathrm{d}\mathbf{x},
\end{align*}

\end_inset

where 
\begin_inset Formula $H_{q}$
\end_inset

 is the entropy of the distribution 
\begin_inset Formula $q$
\end_inset

.
 
\end_layout

\begin_layout Standard
Here we use the KL divergences to minimize the difference between the probabilit
y densities predicted by the Boltzmann generator and the respective reference
 distribution.
 Using the variable transformations (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:transform_zx"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:transform_xz"
plural "false"
caps "false"
noprefix "false"

\end_inset

) and the Boltzmann distribution (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Boltzmann_distribution"
plural "false"
caps "false"
noprefix "false"

\end_inset

), we can express the KL divergence in latent space as:
\begin_inset Formula 
\begin{align*}
\mathrm{KL}_{\boldsymbol{\theta}}\left[q_{Z}\parallel p_{Z}\right] & =H_{Z}-\int q_{Z}(\mathbf{z})\log p_{Z}(\mathbf{z};\boldsymbol{\theta})\mathrm{d}\mathbf{z},\\
 & =H_{Z}-\int q_{Z}(\mathbf{z})\left[\log\mu_{X}(F_{zx}(\mathbf{z};\boldsymbol{\theta}))+\log\left|\det\mathbf{J}_{zx}(\mathbf{z};\boldsymbol{\theta})\right|\right]\mathrm{d}\mathbf{z},\\
 & =H_{Z}+\log Z_{X}+\mathbb{E}_{\mathbf{z}\sim q_{Z}(\mathbf{z})}\left[u(F_{zx}(\mathbf{z};\boldsymbol{\theta}))-\log\left|\det\mathbf{J}_{zx}(\mathbf{z};\boldsymbol{\theta})\right|\right]
\end{align*}

\end_inset

Here, 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 are the trainable neural network parameters.
 Since 
\begin_inset Formula $H_{Z}$
\end_inset

 and 
\begin_inset Formula $Z_{X}$
\end_inset

 are constants in 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

, the KL loss is given by:
\begin_inset Formula 
\begin{equation}
J_{KL}=\mathbb{E}_{\mathbf{z}\sim q_{Z}(\mathbf{z})}\left[u(F_{zx}(\mathbf{z};\boldsymbol{\theta}))-\log\left|\det\mathbf{J}_{zx}(\mathbf{z};\boldsymbol{\theta})\right|\right].\label{eq:loss_KL}
\end{equation}

\end_inset

Practically, each training batch samples points 
\begin_inset Formula $\mathbf{z}\sim q_{Z}(\mathbf{z})$
\end_inset

 from a normal distribution, transformes them via 
\begin_inset Formula $T_{zx}$
\end_inset

, and evaluates Eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:loss_KL"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
We can extend (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:loss_KL"
plural "false"
caps "false"
noprefix "false"

\end_inset

) to simultaneously train at multiple temperatures, obtaining:
\begin_inset Formula 
\[
J_{KL}^{T^{1},...,T^{K}}=\sum_{k=1}^{K}\mathbb{E}_{\mathbf{z}\sim q_{Z}^{k}(\mathbf{z})}\left[u^{k}(F_{zx}(\mathbf{z};\boldsymbol{\theta}))-\log\left|\det\mathbf{J}_{zx}(\mathbf{z};\boldsymbol{\theta})\right|\right].
\]

\end_inset


\end_layout

\begin_layout Paragraph
Interpretation of latent KL as reweighting loss
\end_layout

\begin_layout Standard
The KL loss (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:loss_KL"
plural "false"
caps "false"
noprefix "false"

\end_inset

) has an interesting thermodynamic interpretation.
 By transforming the prior distribution 
\begin_inset Formula $q_{Z}$
\end_inset

 through the Boltzmann generator, we arrive at a proposal distribution 
\begin_inset Formula $p_{X}$
\end_inset

.
 We can now employ reweighting (see below) to turn this proposal distribution
 into a Boltzmann distribution.
 In reweighting, each point is assigned a weight
\begin_inset Formula 
\[
w_{X}(\mathbf{x}\mid\mathbf{z})=\frac{\mu_{X}(\mathbf{x})}{p_{X}(\mathbf{x})}=\frac{p_{Z}(\mathbf{z})}{q_{Z}(\mathbf{z})}.
\]

\end_inset

where the equivalence on the right hand side results from (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:transform_zx"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:transform_xz"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 The minimization of the latent KL divergence can be rewritten in terms
 of these weights:
\begin_inset Formula 
\begin{align*}
\min\mathrm{KL}_{\boldsymbol{\theta}}\left[q_{Z}\parallel p_{Z}\right] & =\min\mathbb{E}_{\mathbf{z}\sim q_{Z}(\mathbf{z})}\left[\log q_{Z}(\mathbf{z})-\log p_{Z}(\mathbf{z};\boldsymbol{\theta})\right]\\
 & =\max\mathbb{E}_{\mathbf{z}\sim q_{Z}(\mathbf{z})}\left[\log w_{X}(\mathbf{x}\mid\mathbf{z})\right].
\end{align*}

\end_inset

Thus, the minimization of the latent KL divergence is equivalent to maximizing
 the expected log-weights of points, or equivalently the product of all
 weights, in a reweighting procedure.
 Indeed the maximum weights are achieved when the proposal distribution
 is identical to the Boltzmann distribution, resulting in 
\begin_inset Formula $w_{X}(\mathbf{x})\equiv1$
\end_inset

.
 
\end_layout

\begin_layout Paragraph
Interpretation of latent KL as free energy
\end_layout

\begin_layout Standard
For invertible transformation 
\begin_inset Formula $F_{xz}$
\end_inset

, we additionally use the following relationship of the entropies of the
 two distributions:
\begin_inset Formula 
\begin{align}
H_{X} & =-\int_{\mathbf{x}}p_{X}(\mathbf{x})\log p_{X}(\mathbf{x})\:\mathrm{d}\mathbf{x}\nonumber \\
 & =-\int_{\mathbf{x}}p_{X}(F_{zx}(\mathbf{z}))\log p_{X}(F_{zx}(\mathbf{z}))\left|\det\mathbf{J}_{zx}(\mathbf{z})\right|\:\mathrm{d}\mathbf{z}\nonumber \\
 & =-\int_{\mathbf{x}}p_{Z}(\mathbf{z})\log p_{X}(F_{zx}(\mathbf{z}))\:\mathrm{d}\mathbf{z}\nonumber \\
 & =-\int_{\mathbf{x}}p_{Z}(\mathbf{z})\log\left(p_{Z}(\mathbf{z})\left|\det\mathbf{J}_{zx}(\mathbf{z})\right|^{-1}\right)\:\mathrm{d}\mathbf{z}\nonumber \\
 & =-\int_{\mathbf{x}}p_{Z}(\mathbf{z})\log p_{Z}(\mathbf{z})\:\mathrm{d}\mathbf{z}+\mathbb{E}_{Z}\log\left|\det\mathbf{J}_{zx}(\mathbf{z})\right|\:\mathrm{d}\mathbf{z}\nonumber \\
 & =H_{Z}+\mathbb{E}_{Z}\log\left|\det\mathbf{J}_{zx}(\mathbf{z})\right|\:\mathrm{d}\mathbf{z}\label{eq:entropy_difference}
\end{align}

\end_inset

Hence we have:
\begin_inset Formula 
\begin{align*}
\mathrm{KL}_{\boldsymbol{\theta}}\left[q_{Z}\parallel p_{Z}\right] & =H_{Z}+\log Z_{X}+\mathbb{E}_{\mathbf{z}\sim q_{Z}(\mathbf{z})}\left[u(F_{zx}(\mathbf{z};\boldsymbol{\theta}))\right]-\mathbb{E}_{\mathbf{z}\sim q_{Z}(\mathbf{z})}\left[\log\left|\det\mathbf{J}_{zx}(\mathbf{z};\boldsymbol{\theta})\right|\right]\\
 & =2H_{Z}+\log Z_{X}+\mathbb{E}_{\mathbf{z}\sim q_{Z}(\mathbf{z})}\left[u(F_{zx}(\mathbf{z};\boldsymbol{\theta}))\right]-H_{X}
\end{align*}

\end_inset

(
\series bold
interpretation unclear
\series default
).
 The loss function becomes a free energy:
\begin_inset Formula 
\begin{align*}
J_{KL} & =\mathbb{E}_{\mathbf{z}\sim q_{Z}(\mathbf{z})}\left[u(F_{zx}(\mathbf{z};\boldsymbol{\theta}))-\log\left|\det\mathbf{J}_{zx}(\mathbf{z};\boldsymbol{\theta})\right|\right]\\
 & =U_{Z}-H_{ZX}
\end{align*}

\end_inset

with the transformation entropy:
\begin_inset Formula 
\[
H_{ZX}=H_{X}-H_{Z}
\]

\end_inset


\end_layout

\begin_layout Paragraph
Configuration KL divergence 
\end_layout

\begin_layout Standard
Likewise, we can express the KL divergence in 
\begin_inset Formula $\mathbf{x}$
\end_inset

 space where we compare the generated distributions with a Boltzmann weight.
 Using (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:transform_zx"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:transform_xz"
plural "false"
caps "false"
noprefix "false"

\end_inset

) and the Gaussian prior density (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:z_Gaussian_prior"
plural "false"
caps "false"
noprefix "false"

\end_inset

), this KL-divergences evaluates as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mathrm{KL}_{\boldsymbol{\theta}}(\mu_{X}\parallel p_{X}) & =H_{X}-\int\mu_{X}(\mathbf{x})\log p_{X}(\mathbf{x};\boldsymbol{\theta})\mathrm{d}\mathbf{x}\\
 & =H_{X}-\int\mu_{X}(\mathbf{x})\left[\log q_{Z}(F_{xz}(\mathbf{x};\boldsymbol{\theta}))+\log\left|\mathbf{J}_{xz}(\mathbf{z};\boldsymbol{\theta})\right|\right]\mathrm{d}\mathbf{x}.\\
 & =H_{X}+\log Z_{Z}+\mathbb{E}_{\mathbf{x}\sim\mu(\mathbf{x})}\left[\frac{1}{\sigma^{2}}\left\Vert F_{xz}(\mathbf{x};\boldsymbol{\theta})\right\Vert ^{2}-\log\left|\mathbf{J}_{xz}(\mathbf{x};\boldsymbol{\theta})\right|\right].
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Although the constants 
\begin_inset Formula $H_{X}$
\end_inset

 and 
\begin_inset Formula $Z_{Z}$
\end_inset

 can be ignored during the training, this loss is difficult to evaluate
 because it needs to sample configurations according to 
\begin_inset Formula $\mu(\mathbf{x})$
\end_inset

, which is actually the problem we are trying to solve.
 
\end_layout

\begin_layout Paragraph
Maximum Likelihood
\end_layout

\begin_layout Standard
However we can approximate the configuration KL divergence by starting from
 a sample 
\begin_inset Formula $\rho(\mathbf{x})$
\end_inset

 and using the loss:
\begin_inset Formula 
\begin{align*}
J_{LL} & =-\mathbb{E}_{\mathbf{x}\sim\rho(\mathbf{x})}\left[\log p_{X}(\mathbf{x};\boldsymbol{\theta})\right]\\
 & =\mathbb{E}_{\mathbf{x}\sim\rho(\mathbf{x})}\left[\frac{1}{\sigma^{2}}\left\Vert F_{xz}(\mathbf{x};\boldsymbol{\theta})\right\Vert ^{2}-\log\left|\mathbf{J}_{xz}(\mathbf{x};\boldsymbol{\theta})\right|\right]
\end{align*}

\end_inset

This loss is the negative log-likelihood, i.e.
 minimizing 
\begin_inset Formula $\mathrm{LL}_{\boldsymbol{\theta}}$
\end_inset

 corresponds to maximizing the likelihood of the sample 
\begin_inset Formula $\rho(\mathbf{x})$
\end_inset

 in the Gaussian prior density.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Multivariate 
\series bold
log-normal distribution
\series default
:
\begin_inset Formula 
\begin{align*}
\mathbf{y} & \sim\mathcal{N}(\mathbf{0},\sigma^{2}\mathbf{I})\\
\mathbf{z} & =e^{\mathbf{y}}
\end{align*}

\end_inset

Then we have the density:
\begin_inset Formula 
\begin{align*}
p(\mathbf{z}) & =\prod_{i=1}^{d}\frac{1}{\sigma z_{i}\sqrt{2\pi}}\mathrm{e}^{-\frac{(\log(z_{i}))^{2}}{2\sigma^{2}}}\\
 & =\frac{1}{\prod_{i=1}^{d}z_{i}}\frac{1}{(2\pi)^{d/2}\sigma^{d}}\mathrm{e}^{-\frac{1}{2\sigma^{2}}\sum_{i=1}^{d}(\log(z_{i}))^{2}}\\
u(z)=-\log p(z) & =\sum_{i=1}^{d}y_{i}+d\log\sigma+\frac{1}{2\sigma^{2}}\left\Vert \mathbf{y}\right\Vert ^{2}+\mathrm{const}
\end{align*}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Symmetric divergence
\end_layout

\begin_layout Standard
The two KL divergences above can be naturally combined to the symmetric
 divergence
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D_{JS}=\frac{1}{2}D_{KL}(p_{X}\parallel p_{Z})+\frac{1}{2}D_{KL}(p_{Z}\parallel p_{X}),
\]

\end_inset

which corresponds, up to an additive constant, to the Jensen-Shannon divergence
 which uses the geometric mean of 
\begin_inset Formula $m=\sqrt{p_{X}p_{Z}}$
\end_inset

 instead of the arithmetic mean.
 
\end_layout

\begin_layout Paragraph
Reaction coordinate loss
\end_layout

\begin_layout Standard
In some applications we do not want to sample from the Boltzmann distribution
 but promote the sampling of high-energy states in a specific direction
 of configuration space, for example in order to compute a free energy profile
 along a predefined reaction coordinate 
\begin_inset Formula $R(\mathbf{x})$
\end_inset

 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

g).
 This is achieved by adding the reaction-coordinate (RC) loss to the minimizatio
n problem:
\begin_inset Formula 
\begin{align*}
J_{RC} & =\int p\left(R(\mathbf{x})\right)\log p\left(R(\mathbf{x})\right)\:\mathrm{d}R(\mathbf{x})\\
 & =\mathbb{E}_{\mathbf{x}\sim p_{X}(\mathbf{x})}\log p\left(R(\mathbf{x})\right).
\end{align*}

\end_inset

To implement this loss, the function 
\begin_inset Formula $R$
\end_inset

 is a user input, minimum and maximum bounds are given, and 
\begin_inset Formula $p\left(R(\mathbf{x})\right)$
\end_inset

 is computed as a batchwise kernel density estimate along between the bounds.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
J_{XX}=\frac{1}{2}D_{KL}\left(p\parallel m\right)+\frac{1}{2}D_{KL}\left(q\parallel m\right)
\]

\end_inset

using
\begin_inset Formula 
\[
m=Z^{-1}\sqrt{pq}
\]

\end_inset

results in:
\begin_inset Formula 
\begin{align*}
J_{XX} & =\frac{1}{2}\int p(x)\left(\log p(x)-\log\sqrt{p(x)q(x)}\right)\\
 & +\frac{1}{2}\int q(x)\left(\log q(x)-\log\sqrt{p(x)q(x)}\right)-Z\\
 & =\frac{1}{2}\int p(x)\left(\log p(x)-\frac{1}{2}\log p(x)-\frac{1}{2}\log q(x)\right)\\
 & +\frac{1}{2}\int q(x)\left(\log q(x)-\frac{1}{2}\log p(x)-\frac{1}{2}\log q(x)\right)-Z\\
 & =\frac{1}{4}\int p(x)\left(\log p(x)-\log q(x)\right)\\
 & +\frac{1}{4}\int q(x)\left(\log q(x)-\log p(x)\right)-Z\\
 & =\frac{1}{4}D_{KL}\left(p\parallel q\right)+\frac{1}{4}D_{KL}\left(q\parallel p\right)-Z
\end{align*}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We can approximate the symmetrized divergence by combining the maximum likelihoo
d and the latent KL-divergence
\begin_inset Formula 
\[
\mathrm{D}_{JS}\approx J_{LL}+J_{KL}.
\]

\end_inset

This approximation becomes exact in the limit where we sample configurations
 
\begin_inset Formula $\mathbf{x}$
\end_inset

 from the Boltzmann distribution.
\end_layout

\begin_layout Section
Sampling the Boltzmann Density
\end_layout

\begin_layout Standard
A trained Boltzmann generator will generally sample from the Boltzmann density
 only approximately.
 The more significant problem is that the Boltzmann generator may not cover
 the complete configuration space.
 Below we describe a number of algorithms to correct the proposal density
 of the Boltzmann generator and to embed it into a sampling algorithm that
 may asymptotically sample the whole configuration space.
\end_layout

\begin_layout Paragraph
Reweighting
\end_layout

\begin_layout Standard
The most direct way to compute quantitative statistics using Boltzmann generator
s is to employ reweighting of probability densities.
 In this framework, we assign to each generated configuration 
\begin_inset Formula $\mathbf{x}$
\end_inset

 the statistical weight:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
w_{X}(\mathbf{x}\mid\mathbf{z}) & =\frac{\mu_{X}(\mathbf{x})}{p_{X}(\mathbf{x})}=\frac{p_{Z}(\mathbf{z})}{q_{Z}(\mathbf{z})}.\label{eq:reweighting_w-1}\\
 & \propto\mathrm{e}^{-u_{X}\left(T_{zx}(\mathbf{z})\right)+u_{Z}(\mathbf{z})+\log\left|\det\left(\mathbf{J}_{zx}(\mathbf{z})\right)\right|}\nonumber 
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Using these weights, expectation values can be computed as
\begin_inset Formula 
\[
\mathbb{E}[O]\approx\frac{\sum_{i=1}^{N}w_{X}(\mathbf{x})O(\mathbf{x})}{\sum_{i=1}^{N}w_{X}(\mathbf{x})}.
\]

\end_inset


\end_layout

\begin_layout Paragraph
Latent MCMC 
\end_layout

\begin_layout Standard
Consider that we always propose 
\begin_inset Formula $\mathbf{z}$
\end_inset

 samples from the prior distribution
\begin_inset Formula 
\[
\mathbf{z}\sim\mathcal{N}(\mathbf{0},\sigma^{2}\mathbf{I})\propto\exp\left(-\frac{1}{2\sigma^{2}}\left\Vert \mathbf{z}\right\Vert ^{2}\right).
\]

\end_inset

Our aim is to sample 
\begin_inset Formula $\mu(\mathbf{x})$
\end_inset

.
 The MCMC acceptance probability should be:
\begin_inset Formula 
\begin{align*}
p_{\mathrm{acc}}(\mathbf{z}_{1}\rightarrow\mathbf{z}_{2}) & =\min\left\{ 1,\frac{p_{Z}(\mathbf{z}_{2})}{p_{Z}(\mathbf{z}_{1})}\frac{p_{\mathrm{prop}}(\mathbf{z}_{2}\rightarrow\mathbf{z}_{1})}{p_{\mathrm{prop}}(\mathbf{z}_{1}\rightarrow\mathbf{z}_{2})}\right\} 
\end{align*}

\end_inset

Using 
\begin_inset Formula 
\[
p_{Z}(z)=J(z)p_{X}(F_{zx}(z))
\]

\end_inset

with
\begin_inset Formula 
\[
J(z)=\left|\det\left(\frac{dF_{zx}}{dz}\right)\right|(z)
\]

\end_inset

we have:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
p_{\mathrm{acc}}(\mathbf{z}_{1}\rightarrow\mathbf{z}_{2}) & =\min\left\{ 1,\frac{J(\mathbf{z}_{2})\mu(F_{zx}(\mathbf{z}_{2}))}{J(\mathbf{z}_{1})\mu(F_{zx}(\mathbf{z}_{1}))}\frac{p_{\mathrm{prop}}(\mathbf{z}_{1})}{p_{\mathrm{prop}}(\mathbf{z}_{2})}\right\} \\
 & =\min\left\{ 1,\frac{\mathrm{e}^{\log J(\mathbf{z}_{2})-u(F_{zx}(\mathbf{z}_{2}))}}{\mathrm{e}^{\log J(\mathbf{z}_{1})-u(F_{zx}(\mathbf{z}_{1}))}}\frac{\mathrm{e}^{-\frac{1}{2\sigma^{2}}\left\Vert \mathbf{z}_{1}\right\Vert ^{2}}}{\mathrm{e}^{-\frac{1}{2\sigma^{2}}\left\Vert \mathbf{z}_{2}\right\Vert ^{2}}}\right\} \\
 & =\min\left\{ 1,\mathrm{e}^{\log J(\mathbf{z}_{2})-u(F_{zx}(\mathbf{z}_{2}))+\frac{1}{2\sigma^{2}}\left\Vert \mathbf{z}_{2}\right\Vert ^{2}-\log J(\mathbf{z}_{1})+u(F_{zx}(\mathbf{z}_{1}))-\frac{1}{2\sigma^{2}}\left\Vert \mathbf{z}_{1}\right\Vert ^{2}}\right\} 
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
In line 2 and 3 we have cancelled equal prefactors: the prefactor involved
 in variable transformation, e.g.
 
\begin_inset Formula $p_{z}(z)=\left|\det\left(S\right)\right|\mu(T_{zx}(z))$
\end_inset

 for the scaled NICER network, and the constant prefactor of the Gaussian
 densities.
 This results in the check:
\begin_inset Formula 
\begin{align*}
r & \le p_{\mathrm{acc}}(\mathbf{z}_{1}\rightarrow\mathbf{z}_{2})\\
-\log r & \ge\log J(\mathbf{z}_{1})-\log J(\mathbf{z}_{2})+u(F_{zx}(\mathbf{z}_{2}))-u(F_{zx}(\mathbf{z}_{1}))+\frac{1}{2\sigma^{2}}\left\Vert \mathbf{z}_{1}\right\Vert ^{2}-\frac{1}{2\sigma^{2}}\left\Vert \mathbf{z}_{2}\right\Vert ^{2}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection*
C.
 Systems and Hyperparameters
\end_layout

\begin_layout Paragraph*
Double well
\end_layout

\begin_layout Standard
We define a two-dimensional toy model which is bistable in 
\begin_inset Formula $x$
\end_inset

-direction and harmonic in 
\begin_inset Formula $y$
\end_inset

-direction:
\begin_inset Formula 
\[
E(x,y)=\frac{1}{4}ax^{4}-\frac{1}{2}bx^{2}+cx+\frac{1}{2}dy^{2}
\]

\end_inset

with 
\begin_inset Formula $a=c=d=1$
\end_inset

 and 
\begin_inset Formula $b=6$
\end_inset

 ‚Äì see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for the potential in 
\begin_inset Formula $x$
\end_inset

-direction.
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Network
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
epochs ML
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
epochs KL
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{10}S$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1000
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $R_{10}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1000
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Paragraph
Particle dimer
\end_layout

\begin_layout Standard
Here we simulate two-dimensional system of a particle dimer in a bath of
 
\begin_inset Formula $n_{s}=36$
\end_inset

 solvent particles.
 The configuration vector is defined by alternating 
\begin_inset Formula $x-$
\end_inset

 and 
\begin_inset Formula $y-$
\end_inset

 positions and starting with the two dimer particles:
\begin_inset Formula 
\[
\mathbf{x}=\left[\mathbf{x}_{1x},\mathbf{x}_{1y},\mathbf{x}_{2x},\mathbf{x}_{2y},...,\mathbf{x}_{(n_{s}+2)x},\mathbf{x}_{(n_{s}+2)y}\right].
\]

\end_inset

Defining the dimer distance 
\begin_inset Formula $d=\left\Vert \mathbf{x}_{1}-\mathbf{x}_{2}\right\Vert $
\end_inset

, and the Heavyside step function 
\begin_inset Formula $h$
\end_inset

, we use the potential energy:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
U(\mathbf{x}) & =k_{d}(\mathbf{x}_{1x}+\mathbf{x}_{2x})^{2}+k_{d}\mathbf{x}_{1y}^{2}+k_{d}\mathbf{x}_{2y}^{2}\\
 & +\frac{1}{4}a(d-d_{0})^{4}-\frac{1}{2}b(d-d_{0})^{2}+c(d-d_{0})^{4}\\
 & +\sum_{i=1}^{n+2}h(-\mathbf{x}_{1x}-l_{\mathrm{box}})k_{\mathrm{box}}(-\mathbf{x}_{1x}-l_{\mathrm{box}})^{2}+\sum_{i=1}^{n+2}h(\mathbf{x}_{1x}-l_{\mathrm{box}})k_{\mathrm{box}}(\mathbf{x}_{1x}-l_{\mathrm{box}})^{2}\\
 & +\sum_{i=1}^{n+2}h(-\mathbf{x}_{1y}-l_{\mathrm{box}})k_{\mathrm{box}}(-\mathbf{x}_{1y}-l_{\mathrm{box}})^{2}+\sum_{i=1}^{n+2}h(\mathbf{x}_{1y}-l_{\mathrm{box}})k_{\mathrm{box}}(\mathbf{x}_{1y}-l_{\mathrm{box}})^{2}\\
 & +\epsilon\sum_{i=1}^{n+1}\sum_{j=i+1,j\neq2}^{n+2}\left(\frac{\sigma}{\left\Vert \mathbf{x}_{i}-\mathbf{x}_{j}\right\Vert }\right)^{12}
\end{align*}

\end_inset

where the five rows correspond to: (1) Constraints for the center and the
 
\begin_inset Formula $y$
\end_inset

-position of the particle dimer, (2) particle dimer interaction, (3,4) box
 constraints in 
\begin_inset Formula $x-$
\end_inset

 and 
\begin_inset Formula $y-$
\end_inset

direction, (5) particle repulsion.
 The following parameter values were used:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="10">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\epsilon$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k_{d}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $d_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $a$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $b$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $l_{\mathrm{box}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k_{\mathrm{box}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100.0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Boltzmann Generator training was done with 
\begin_inset Formula $w_{KL}=1$
\end_inset

 and decreasing 
\begin_inset Formula $w_{ML}$
\end_inset

 according to the following schedule:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="6">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Epochs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
300
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
300
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2000
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w_{ML}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
0.01
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w_{KL}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w_{RC}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
10
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
The italic values in the last row were treated as variable hyperparameters.
 We then did a hyperparameter search as indicated in the table below.
 The hyperparameters were chosen by minimizing the estimator variance for
 the free energy profile along dimer distance 
\begin_inset Formula $d$
\end_inset

.
 Each trained network makes predictions for the free energy profile shown
 in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:particle_dimer"
plural "false"
caps "false"
noprefix "false"

\end_inset

i.
 Using bootstrapping the standard error over all free energies along the
 profile between 
\begin_inset Formula $d=[0.5,2.5]$
\end_inset

 are computed, resulting in 
\begin_inset Formula $(\epsilon_{0.5},\epsilon_{1.0},\epsilon_{2.0})$
\end_inset

 for the three temperatures and 
\begin_inset Formula $\bar{\epsilon}=\sqrt{\epsilon_{0.5}^{2}+\epsilon_{1.0}^{2}+\epsilon_{2.0}^{2}}$
\end_inset

 as a total estimator error.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="24" columns="9">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Architecture
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $nl_{\mathrm{layers}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $nl_{hidden}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w_{ML}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w_{RC}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\epsilon_{0.5}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\epsilon_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\epsilon_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sqrt{\sum\epsilon^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{R}_{8}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.62
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.07
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.04
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.33
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{R}_{4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.53
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.27
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{R}_{6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.69
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.29
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.28
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{R}_{12}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.49
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.85
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(\mathrm{RN})_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.59
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.56
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.62
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(\mathrm{RN})_{7}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.76
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.29
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.39
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.20
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(\mathrm{RN})_{12}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.44
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.66
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.96
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{R}_{8}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.51
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.97
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.97
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{R}_{4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.41
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.59
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.78
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.77
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{R}_{6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.49
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.76
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.88
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{R}_{12}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.84 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.28 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.17
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(\mathrm{RN})_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.84
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.29
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.18
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(\mathrm{RN})_{7}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.65
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.07
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.16
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(\mathrm{RN})_{12}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.87
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.58
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.74
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathrm{R}_{8}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.85
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.58
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.48
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.69
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.51
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.52
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.73
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.02
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.85
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.12
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
0.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.58
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.33
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1.33
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2.45
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.87
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.63
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.15
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.66
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.02
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.72
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.81
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.03
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\cdot$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.88
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.06
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.84
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.34
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:hyperparameters_particle_dimer"

\end_inset

Hyperparameter selection for the particle dimer.
 In the architecture, 
\begin_inset Formula $R$
\end_inset

 corresponds to a RealNVP and 
\begin_inset Formula $N$
\end_inset

 to a NICE double layer with channel swaps (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_network-architecture"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 The subscript indicates the number of repetitions, e.g.
 
\begin_inset Formula $\mathrm{R}_{4}=\mathrm{RRRR}$
\end_inset

, corresponding to eight single layers.
 All nonlinear transformations (
\begin_inset Formula $T$
\end_inset

, 
\begin_inset Formula $S$
\end_inset

) used dense networks with 
\begin_inset Formula $\mathrm{tanh}$
\end_inset

 activation using the given number of layers (
\begin_inset Formula $nl_{layers}$
\end_inset

) and hidden nodes (
\begin_inset Formula $nl_{hidden}$
\end_inset

).
 All networks were trained on the following range of relative temperatures:
 
\begin_inset Formula $\tau\in[0.1,0.25,0.5,0.75,1,1.5,2,3,4]$
\end_inset

 and used 
\begin_inset Formula $w_{KL}=1.0$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Free energy (umbrella sampling) vs dimer potential :
\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/particle_dimer_energies.pdf
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Hydrocarbons
\end_layout

\begin_layout Standard
A simple molecular mechanics model including bond, angle, torsion and Lennard-Jo
nes interactions (between all pairs) was implemented in TensorFlow.
 We use the parameters in 
\begin_inset CommandInset citation
LatexCommand cite
key "NikitinEtAl_JMolModel14_AMBERAlkanes"
literal "false"

\end_inset

 to modeling the alkanes shown in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hydrocarbon"
plural "false"
caps "false"
noprefix "false"

\end_inset

: (1) cyclononane 
\begin_inset Formula $C_{9}H_{18}$
\end_inset

, i.e.
 a ring of nine 
\begin_inset Formula $CH_{2}$
\end_inset

 groups, and (2) bicyclo[4.4.4]tetradecane 
\begin_inset Formula $C_{14}H_{26}$
\end_inset

, connected as follows:
\begin_inset Formula 
\[
\begin{array}{c}
-CH_{2}-CH_{2}-CH_{2}-CH_{2}-\\
/\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\backslash\\
CH-CH_{2}-CH_{2}-CH_{2}-CH_{2}-CH\\
\backslash\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:/\\
-CH_{2}-CH_{2}-CH_{2}-CH_{2}-
\end{array}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
clearpage
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
D.
 Supplementary Figures
\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/SFig_Training_NICER.pdf
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig_training_methods_NICER"

\end_inset

Different methods for training Boltzmann Generators with NICE layers using
 the double well example shown in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:double_well"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\begin_inset Formula $1^{st}$
\end_inset

 column: distribution in configuration space 
\begin_inset Formula $\mathbf{x}$
\end_inset

, 
\begin_inset Formula $1^{nd}$
\end_inset

 column: distribution in latent space 
\begin_inset Formula $\mathbf{z}$
\end_inset

, 
\begin_inset Formula $3^{rd}$
\end_inset

 column: free energy of Boltzmann Generator output 
\begin_inset Formula $p_{X}(\mathbf{x})$
\end_inset

 along 
\begin_inset Formula $x_{1}$
\end_inset

, 
\begin_inset Formula $4^{th}$
\end_inset

 column: free energy after reweighting.
 ML
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/SFig_Training_RealNVP.pdf
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig_training_methods_RealNVP"

\end_inset

Same as Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig_training_methods_NICER"
plural "false"
caps "false"
noprefix "false"

\end_inset

 but for Boltzmann Generators using RealNVP layers.
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_body
\end_document
